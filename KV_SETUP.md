# Настройка Vercel KV для мгновенного обновления домена

## Что изменилось

Теперь домен хранится в **Vercel KV** (Redis) вместо переменных окружения. Это позволяет обновлять домен мгновенно без пересборки проекта!

## Настройка Vercel KV

### Шаг 1: Создайте KV Database на Vercel

1. Зайдите в проект на Vercel
2. Перейдите в **Storage** → **Create Database**
3. Выберите **KV** (Redis)
4. Создайте базу данных (можно назвать `verification-domain` или любое другое имя)
5. Выберите регион (ближайший к вашему проекту)

### Шаг 2: Подключите KV к проекту

После создания базы данных:

1. Vercel автоматически добавит переменные окружения:
   - `KV_REST_API_URL`
   - `KV_REST_API_TOKEN`
   - `KV_REST_API_READ_ONLY_TOKEN`

2. Эти переменные будут доступны автоматически в вашем проекте

### Шаг 3: Установите зависимости

Убедитесь, что установлен пакет `@vercel/kv`:

```bash
npm install @vercel/kv
```

Или если используете pnpm:
```bash
pnpm install @vercel/kv
```

### Шаг 4: Пересоберите проект

После настройки KV пересоберите проект один раз:

- В Vercel: Deployments → ... → Redeploy
- Или сделайте новый коммит и пуш

## Как это работает

1. **Хранение:** Домен хранится в KV (Redis) - быстром хранилище
2. **Чтение:** При каждом запросе домен читается из KV
3. **Обновление:** При команде `/changedomain` домен обновляется в KV мгновенно
4. **Без пересборки:** Изменения применяются сразу, без пересборки проекта!

## Использование

После настройки просто отправьте боту:

```
/changedomain createsync.click
```

Домен изменится **мгновенно** и будет доступен сразу же!

## Проверка

Проверьте текущий домен:

```
/domain
```

## Важно!

- ✅ KV Database должна быть создана и подключена к проекту
- ✅ Переменные окружения KV должны быть доступны (добавляются автоматически)
- ✅ После первой настройки нужно пересобрать проект один раз
- ✅ После этого все изменения применяются мгновенно без пересборки!

## Fallback

Если KV недоступен, система использует:
1. Переменную окружения `VERIFICATION_DOMAIN` (если установлена)
2. Значение по умолчанию `createsync.help`

Это обеспечивает надежность работы даже если KV временно недоступен.
